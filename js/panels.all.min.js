/*
 LICENSE

 The MIT License

 Copyright (c) 2010-2012 Arthur Clemens, arthur@visiblearea.com

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions: 

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */var UndoManager=function(){"use strict";function i(e){if(!e)return;n=!0;e.f.apply(e.o,e.p);n=!1}function s(e,t,n,r,i,s,o,u){return{undo:{o:e,f:t,p:n,m:r},redo:{o:i,f:s,p:o,m:u}}}var e=[],t=-1,n=!1,r;return{register:function(i,o,u,a,f,l,c,h){if(n)return;e.splice(t+1,e.length-t);e.push(s(i,o,u,a,f,l,c,h));t=e.length-1;r&&r()},setCallback:function(e){r=e},undo:function(){var n=e[t];if(!n)return;i(n.undo);t-=1;r&&r()},redo:function(){var n=e[t+1];if(!n)return;i(n.redo);t+=1;r&&r()},clear:function(){var n=e.length;e=[];t=-1;r&&n>0&&r()},hasUndo:function(){return t!==-1},hasRedo:function(){return t<e.length-1}}};jQuery(function(e){panels.animations=e("#panels").data("animations");e(window).bind("resize",function(t){if(e(t.target).hasClass("ui-resizable"))return;e("#panels-container .grid-container").panelsResizeCells()});e("#panels-container").sortable({items:"> .grid-container",handle:".grid-handle",tolerance:"pointer",stop:function(){e(this).find(".cell").each(function(){e(this).find('input[name$="[grid]"]').val(e("#panels-container .grid-container").index(e(this).closest(".grid-container")))});e("#panels-container .panels-container").trigger("refreshcells")}});var t={};t[panels.i10n.buttons.add]=function(){var t=Number(e("#grid-add-dialog").find("input").val());if(isNaN(t)){alert("Invalid Number");return!1}t=Math.min(10,Math.max(1,Math.round(t)));var n=window.panels.createGrid(t);panels.animations?n.hide().slideDown():n.show();e("#grid-add-dialog").dialog("close")};e("#grid-add-dialog").show().dialog({dialogClass:"panels-admin-dialog",autoOpen:!1,modal:!1,title:e("#grid-add-dialog").attr("data-title"),open:function(){e(this).find("input").val(2).select();var t=e('<div class="siteorigin-panels ui-widget-overlay ui-widget-overlay ui-front"></div>').css("z-index",80001);e(this).data("overlay",t).closest(".ui-dialog").before(t)},close:function(){e(this).data("overlay").remove()},buttons:t}).on("keydown",function(n){if(n.keyCode==e.ui.keyCode.ENTER){t[panels.i10n.buttons.add]();setTimeout(function(){e("#grid-add-dialog").dialog("close")},1)}else n.keyCode===e.ui.keyCode.ESCAPE&&e("#grid-add-dialog").dialog("close")});e("#panels-dialog").show().dialog({dialogClass:"panels-admin-dialog",autoOpen:!1,resizable:!1,draggable:!1,modal:!1,title:e("#panels-dialog").attr("data-title"),minWidth:960,maxHeight:Math.round(e(window).height()*.8),open:function(){var t=e('<div class="siteorigin-panels-ui-widget-overlay ui-widget-overlay ui-front"></div>').css("z-index",80001);e(this).data("overlay",t).closest(".ui-dialog").before(t)},close:function(){e(this).data("overlay").remove();panels.animations?e("#panels-container .panel.new-panel").hide().slideDown(1e3).removeClass("new-panel"):e("#panels-container .panel.new-panel").show().removeClass("new-panel")}}).on("keydown",function(t){t.keyCode===e.ui.keyCode.ESCAPE&&e(this).dialog("close")});e("#so-panels-panels .handlediv").click(function(){setTimeout(function(){e(window).resize()},150)});e("#panels .panels-add").button({icons:{primary:"ui-icon-add"},text:!1}).click(function(){e("#panels-text-filter-input").val("").keyup();e("#panels-dialog").dialog("open");return!1});e("#panels .grid-add").button({icons:{primary:"ui-icon-columns"},text:!1}).click(function(){e("#grid-add-dialog").dialog("open");return!1});e("#siteorigin-widgets-link").data("text",e("#siteorigin-widgets-link").html());e("#panels-text-filter-input").keyup(function(t){if(t.keyCode==13){var n=e("#panels-dialog .panel-type-list .panel-type:visible");n.length==1&&n.click();return}var r=e(this).val().toLowerCase();e("#panels-dialog .panel-type-list .panel-type").show().each(function(){if(r=="")return;e(this).find("h3").html().toLowerCase().indexOf(r)==-1&&e(this).hide()})}).click(function(){e(this).keyup()});e("#panels-dialog .panel-type").click(function(){var t=e("#panels-dialog").panelsCreatePanel(e(this).attr("data-class"));panels.addPanel(t,null,null,!0);e("#panels-dialog").dialog("close")});typeof panelsData!="undefined"?panels.loadPanels(panelsData):panels.createGrid(1);e(window).resize(function(){e(".panels-admin-dialog").filter(":data(dialog)").dialog("option","position","center")});e("#wp-content-editor-tools").find(".wp-switch-editor").click(function(){var t=e(this);e("#wp-content-editor-container, #post-status-info").show();e("#so-panels-panels").hide();e("#wp-content-wrap").removeClass("panels-active");e("#content-resize-handle").show()}).end().prepend(e('<a id="content-panels" class="hide-if-no-js wp-switch-editor switch-panels">'+e("#so-panels-panels h3.hndle span").html()+"</a>").click(function(){var t=e(this);e("#wp-content-wrap").removeClass("tmce-active html-active");e("#wp-content-editor-container, #post-status-info").hide();e("#so-panels-panels").show().find("> .inside").show();e("#wp-content-wrap").addClass("panels-active");e(window).resize();e("#content-resize-handle").hide();return!1}));e("#wp-content-editor-tools .wp-switch-editor").click(function(){var t=e(this),n=t.attr("id").split("-");e("#wp-content-wrap").addClass(n[1]+"-active")});e("#panels-home-page #post-body").show();e("#panels-home-page #post-body-wrapper").css("background","none");e("#so-panels-panels").insertAfter("#wp-content-editor-container").addClass("wp-editor-container").hide().find(".handlediv").remove().end().find(".hndle").html("").append(e("#add-to-panels"));e("#content-panels").click(function(){e(window).resize()});(typeof panelsData!="undefined"||e("#panels-home-page").length)&&e("#content-panels").click();setTimeout(function(){(typeof panelsData!="undefined"||e("#panels-home-page").length)&&e("#content-panels").click();e("#so-panels-panels .hndle").unbind("click");e("#so-panels-panels .cell").eq(0).click()},150);if(e("#panels-home-page").length){e("#content-tmce, #content-html").remove();e("#content-panels").hide();e("#panels-toggle-switch").mouseenter(function(){e(this).addClass("subtle-move")}).click(function(){e(this).toggleClass("state-off").toggleClass("state-on").removeClass("subtle-move");e("#panels-home-enabled").val(e(this).hasClass("state-off")?"false":"true")});e("#post-preview").click(function(t){var n=e("#panels-container").closest("form"),r=n.attr("action");n.attr("action",panels.previewUrl).attr("target","_blank").submit().attr("action",r).attr("target","_self");t.preventDefault()})}e("#panels").append('<input name="panels_js_complete" type="hidden" value="1" />')});(function(e){var t=0;panels.undoManager=new UndoManager;e.fn.panelsGetPanelData=function(){var t=e(this),n={},r;t.data("missing")===!0?n=JSON.parse(t.find('input[name$="[data]"]').val()):typeof t.data("dialog")!="undefined"&&!t.data("dialog").hasClass("ui-dialog-content-loading")?t.data("dialog").find("*[name]").not("[data-info-field]").each(function(){var t=e(this),i=/widgets\[[0-9]+\]\[(.*)\]/.exec(t.attr("name"));i=i[1];r=i.split("][");r=r.map(function(e){return!isNaN(parseFloat(e))&&isFinite(e)?parseInt(e):e});var s=n;for(var o=0;o<r.length;o++)if(o==r.length-1)t.attr("type")=="checkbox"?t.is(":checked")&&(s[r[o]]=t.val()!=""?t.val():!0):s[r[o]]=t.val();else{typeof s[r[o]]=="undefined"&&(s[r[o]]={});s=s[r[o]]}}):t.find('input[name$="[data]"]').val()==""?n={}:n=JSON.parse(t.find('input[name$="[data]"]').val());return n};e.fn.panelsCreatePanel=function(n,r){e("#panels-undo-message").fadeOut(function(){e(this).remove()});var i,s=t++,o=e(this),u=e('<div class="panel new-panel"><div class="panel-wrapper"><div class="title"><h4></h4><span class="actions"></span></div><small class="description"></small></div></div>');u.attr("data-type",n).append(e('<input type="hidden" name="widgets['+s+'][data]" type="hidden">').val(JSON.stringify(r))).append(e('<input type="hidden" name="widgets['+s+'][info][raw]" type="hidden">').val(0)).append(e('<input type="hidden" name="widgets['+s+'][info][grid]" type="hidden">')).append(e('<input type="hidden" name="widgets['+s+'][info][cell]" type="hidden">')).append(e('<input type="hidden" name="widgets['+s+'][info][id]" type="hidden">').val(s)).append(e('<input type="hidden" name="widgets['+s+'][info][class]" type="hidden">').val(n)).append(e('<input type="hidden" name="panel_order[]" type="hidden">').val(s)).data("raw",!1).find("h4, h5").click(function(){e(this).closest(".panel").find("a.edit").click();return!1});var a=o.find(".panel-type").filter(function(){return e(this).data("class")===n});if(a.length!=0)u.data({title:a.data("title")}).find(".description").html(a.find(".description").html()).end().find(".title h4").html(a.find("h3").html());else{if(typeof panelsMissingWidgets=="undefined"||typeof panelsMissingWidgets[n]=="undefined")return;u.data({title:panelsMissingWidgets[n].title,missing:!0}).find(".description").html(panelsMissingWidgets[n].description).end().find(".title h4").html(panelsMissingWidgets[n].title)}u.panelsSetPanelTitle(r);var f=function(){panels.undoManager.register(this,function(t,n,r,i){var s=e("#panels-dialog").panelsCreatePanel(t,n,r);panels.addPanel(s,r,i,!0);e("#panels-container .panel").removeClass("new-panel")},[u.attr("data-type"),u.panelsGetPanelData(),u.closest(".panels-container"),u.index()],"Remove Panel");e("#panels-undo-message").remove();e('<div id="panels-undo-message" class="updated"><p>'+panels.i10n.messages.deleteWidget+' - <a href="#" class="undo">'+panels.i10n.buttons.undo+"</a></p></div>").appendTo("body").hide().slideDown().find("a.undo").click(function(){panels.undoManager.undo();e("#panels-undo-message").fadeOut(function(){e(this).remove()});return!1});var t=function(){var e=u.closest(".grid-container");u.remove();e.panelsResizeCells()};if(panels.animations)u.slideUp(t);else{u.hide();t()}};u.find(".title .actions").append(e("<a>"+panels.i10n.buttons.edit+"<a>").addClass("edit").click(function(){if(typeof i!="undefined")return!1;var t={},r=!1;t[panels.i10n.buttons.done]=function(){r=!0;e(this).trigger("panelsdone",u,i);var t=u.panelsGetPanelData();if(i.find(".panels-missing-widget-form").length==0){u.find('input[name$="[data]"]').val(JSON.stringify(t));u.panelsSetPanelTitle(t);u.find('input[name$="[info][raw]"]').val(1)}i.dialog("close")};i=e('<div class="panel-dialog dialog-form"></div>').data("widget-type",n).addClass("ui-dialog-content-loading").addClass("widget-dialog-"+n.toLowerCase()).dialog({dialogClass:"panels-admin-dialog",autoOpen:!0,modal:!1,draggable:!1,resizable:!1,title:panels.i10n.messages.editWidget.replace("%s",u.data("title")),width:Math.round(e(window).width()*.9),height:Math.round(e(window).height()*.875),create:function(t,n){e(this).closest(".ui-dialog").find(".show-in-panels").show()},open:function(){e(this).closest(".ui-dialog").find("a").blur();var t=e('<div class="siteorigin-panels-ui-widget-overlay ui-widget-overlay ui-front"></div>').css("z-index",80001);e(this).data("overlay",t).closest(".ui-dialog").before(t)},close:function(){r||e(this).trigger("panelsdone",u,i);e(this).data("overlay").remove();e(this).dialog("destroy").remove();i=undefined},buttons:t}).keypress(function(t){if(t.keyCode==e.ui.keyCode.ENTER){if(e(this).closest(".ui-dialog").find("textarea:focus").length>0)return;e(this).closest(".ui-dialog").find(".ui-dialog-buttonpane .ui-button:eq(0)").click();t.preventDefault();return!1}t.keyCode===e.ui.keyCode.ESCAPE&&e(this).closest(".ui-dialog").dialog("close")});u.data("dialog",i);var o=n;try{o=o.replace("\\\\","\\")}catch(a){return}e.post(ajaxurl,{action:"so_panels_widget_form",widget:o,instance:JSON.stringify(u.panelsGetPanelData()),raw:u.find('input[name$="[info][raw]"]').val()},function(t){try{t=t.replace(/\{\$id\}/g,s)}catch(n){t=""}i.html(t).dialog("option","position","center");var r=i.find("a.siteorigin-panels-help-link");r.length&&r.attr("target","_blank").prependTo(i.closest(".ui-dialog").find(".ui-dialog-buttonpane"));e(window).resize();e(document).trigger("panelssetup",u,i);e("#panels-container .panels-container").trigger("refreshcells");i.removeClass("ui-dialog-content-loading").trigger("panelsopen",u,i)},"html");return!1})).append(e("<a>"+panels.i10n.buttons.duplicate+"<a>").addClass("duplicate").click(function(){var t=e("#panels-dialog").panelsCreatePanel(u.attr("data-type"),u.panelsGetPanelData());window.panels.addPanel(t,u.closest(".panels-container"),null,!1);t.removeClass("new-panel");return!1})).append(e("<a>"+panels.i10n.buttons.delete+"<a>").addClass("delete").click(function(){f();return!1}));return u};panels.addPanel=function(t,n,r,i){n==null&&(n=e("#panels-container .cell.cell-selected .panels-container").eq(0));n.length==0&&(n=e("#panels-container .cell .panels-container").eq(0));if(n.length==0){panels.createGrid(1,[1]);n=e("#panels-container .cell .panels-container").eq(0)}if(r==null)n.append(t);else{var s=n.find(".panel").eq(r);s.length==0?n.append(t):t.insertBefore(s)}n.sortable("refresh").trigger("refreshcells");n.closest(".grid-container").panelsResizeCells();if(i)if(panels.animations)e("#panels-container .panel.new-panel").hide().slideDown(450,function(){t.find("a.edit").click()}).removeClass("new-panel");else{e("#panels-container .panel.new-panel").show().removeClass("new-panel");t.find("a.edit").click()}};e.fn.panelsSetPanelTitle=function(t){return e(this).each(function(){var n="";if(typeof t!="undefined")if(typeof t.title!="undefined"&&t.title!="")n=t.title;else for(var r in t)if(typeof t[r]=="string"&&t[r]!=""){n=t[r];break}try{n=n.substring(0,80).replace(/(<([^>]+)>)/ig,"")}catch(i){n=""}e(this).find("h4").html(e(this).data("title")+"<span>"+n+"</span>")})};panels.loadPanels=function(t){panels.clearGrids();if(typeof t!="undefined"&&typeof t.grids!="undefined")for(var n in t.grids){var r=[];for(var i in t.grid_cells)Number(t.grid_cells[i]["grid"])==n&&(r[r.length]=Number(t.grid_cells[i].weight));var s=panels.createGrid(Number(t.grids[n].cells),r,t.grids[n].style);for(var o in t.widgets){if(typeof t.widgets[o]["info"]=="undefined")continue;if(Number(t.widgets[o]["info"]["grid"])==n){var u=t.widgets[o],a=e("#panels-dialog").panelsCreatePanel(u.info["class"],u);s.find(".panels-container").eq(Number(t.widgets[o].info.cell)).append(a)}}}e("#panels-container .panels-container").sortable("refresh").trigger("refreshcells");e("#panels-container .panel").removeClass("new-panel");e("#panels-container .grid-container").each(function(){e(this).panelsResizeCells()})}})(jQuery);(function(e){var t=0,n=0;e.fn.panelsResizeCells=function(){return e(this).each(function(){var t=e(this);t.find(".grid, .grid .cell, .grid .cell .cell-wrapper").css("height","auto");var n=t.find(".grid").outerWidth();t.find(".grid .cell").length>1&&t.find(".grid .cell").each(function(){e(this).is(".first, .last")?n-=6:n-=12});var r=0,i=0;t.find(".grid .cell").each(function(){i=Math.max(i,e(this).height());e(this).width(Math.floor(n*Number(e(this).attr("data-percent")))).css("left",r);r+=e(this).width()+12});t.find(".grid, .grid .cell, .grid .cell .cell-wrapper").css("height",Math.max(i,68))})};panels.createGrid=function(r,i,s){if(i==null||i.length==0){i=[];for(var o=0;o<r;o++)i[o]=1}typeof s=="undefined"&&(s={});var u=0;for(var a in i)u+=i[a];var f=e("<div />").addClass("grid-container").appendTo("#panels-container");f.append(e('<input type="hidden" name="grids['+t+'][cells]" />').val(r));var l={};for(var c in panelsStyleFields){l[c]=e('<input type="hidden" name="grids['+t+"][style]["+c+']" data-style-field="'+c+'" />').appendTo(f);typeof s[c]!="undefined"&&(panelsStyleFields[c]["type"]=="checkbox"?l[c].val(s[c]?"true":""):l[c].val(s[c]))}f.append(e('<div class="controls" />').append(e('<div class="ui-button ui-button-icon-only"><div class="ui-icon ui-icon-remove"></div></div>').attr("data-tooltip",panels.i10n.buttons["delete"]).click(function(){e(this).removeTooltip();var t=[];f.find(".cell").each(function(n,r){t[n]={weight:Number(e(this).attr("data-percent")),widgets:[]};e(this).find(".panel").each(function(r,i){t[n].widgets[r]={type:e(this).attr("data-type"),data:e(this).panelsGetPanelData()}})});window.panels.undoManager.register(this,function(t,n){var r=[];for(var i=0;i<t.length;i++)r[i]=t[i].weight;var s=window.panels.createGrid(r.length,r);for(var i=0;i<t.length;i++)for(var o=0;o<t[i].widgets.length;o++){var u=t[i].widgets[o],a=e("#panels-dialog").panelsCreatePanel(u.type,u.data);window.panels.addPanel(a,s.find(".panels-container").eq(i))}if(n!=s.index()){var f=e("#panels-container .grid-container").eq(n);if(f.length){s.insertBefore(f);e("#panels-container").sortable("refresh");e("#panels-container").find(".cell").each(function(){e(this).find('input[name$="[grid]"]').val(e("#panels-container .grid-container").index(e(this).closest(".grid-container")))});e("#panels-container .panels-container").trigger("refreshcells")}}e("#panels-container .panel").removeClass("new-panel");panels.animations?s.hide().slideDown():s.show()},[t,f.index()],"Remove Columns");e("#panels-undo-message").remove();e('<div id="panels-undo-message" class="updated"><p>'+panels.i10n.messages.deleteColumns+' - <a href="#" class="undo">'+panels.i10n.buttons.undo+"</a></p></div>").appendTo("body").hide().fadeIn().find("a.undo").click(function(){window.panels.undoManager.undo();e("#panels-undo-message").fadeOut(function(){e(this).remove()});return!1});var n=function(){f.remove();e("#panels-container").sortable("refresh").find(".panels-container").trigger("refreshcells")};if(panels.animations)f.slideUp(n);else{f.hide();n()}return!1})).append(e('<div class="ui-button ui-button-icon-only panels-visual-style"><div class="ui-icon ui-icon-gear"></div></div>').attr("data-tooltip","Visual Style").click(function(){panels.loadStyleValues(f)})).append(e('<div class="ui-button ui-button-icon-only grid-handle"><div class="ui-icon ui-icon-move"></div></div>')));Object.keys(panelsStyleFields).length||f.find(".panels-visual-style").remove();var h=e("<div />").addClass("grid").appendTo(f);for(var o=0;o<r;o++){var p=e('<div class="cell" data-percent="'+i[o]/u+'">'+'<div class="cell-wrapper panels-container"></div>'+'<div class="cell-width"><div class="cell-width-left"></div><div class="cell-width-right"></div><div class="cell-width-line"></div><div class="cell-width-value"><span></span></div></div>'+"</div>");o==0&&p.addClass("first");o==r-1&&p.addClass("last");h.append(p);p.append(e('<input type="hidden" name="grid_cells['+n+'][weight]" />').val(i[o]/u)).append(e('<input type="hidden" name="grid_cells['+n+'][grid]" />').val(t)).data("cellId",n);n++}h.append(e("<div />").addClass("clear"));t++;panels.setupGrid(f);return f};panels.setupGrid=function(t){e("#panels-undo-message").fadeOut(function(){e(this).remove()});t.panelsResizeCells();t.find(".grid .cell").not(".first").each(function(){var n,r;e(this).resizable({handles:"w",containment:"parent",start:function(t,i){n=e(this).prev().outerWidth();r=e(this).prev().position().left},stop:function(e,n){t.find(".grid .cell").not(".first").resizable("disable").resizable("enable")},resize:function(n,r){var i=e(this),s=e(this).prev();s.css("width",i.position().left-s.position().left-12);var o=0;t.find(".grid .cell").each(function(){o+=e(this).width()}).each(function(){var t=e(this).width()/o;e(this).find(".cell-width-value span").html(Math.round(t*1e3)/10+"%");e(this).attr("data-percent",t).find('input[name$="[weight]"]').val(t)});t.panelsResizeCells()}})});t.find(".grid .cell .ui-resizable-handle").dblclick(function(){var n=e(this).closest(".cell"),r=n.prev(),i=Number(n.attr("data-percent"))+Number(r.attr("data-percent"));n.attr("data-percent",i/2).find('input[name$="[weight]"]').val(i/2);r.attr("data-percent",i/2).find('input[name$="[weight]"]').val(i/2);n.add(r).find(".cell-width-value span").html(Math.round(i/2*1e3)/10+"%");t.panelsResizeCells();return!1});t.find(".grid .cell").click(function(){e(".grid .cell").removeClass("cell-selected");e(this).addClass("cell-selected")}).each(function(){var t=Number(e(this).attr("data-percent"));e(this).find(".cell-width-value span").html(Math.round(t*1e3)/10+"%")}).find(".panels-container").sortable({placeholder:"ui-state-highlight",connectWith:".panels-container",tolerance:"pointer",change:function(t){var n=e("#panels-container .ui-state-highlight").closest(".cell").get(0);if(typeof this.lastContainer!="undefined"&&this.lastContainer!=n){e(this.lastContainer).closest(".grid-container").panelsResizeCells();e(n).closest(".grid-container").panelsResizeCells();n.click()}this.lastContainer=n},helper:function(e,t){return t.clone().css("opacity",panels.animations?.9:1).addClass("panel-being-dragged")},stop:function(t,n){e("#panels-container .grid-container").each(function(){e(this).panelsResizeCells()})},receive:function(){e(this).trigger("refreshcells")}}).bind("refreshcells",function(){e("#panels-container .panel").each(function(){var t=e(this).closest(".grid-container");e(this).find('input[name$="[info][grid]"]').val(e("#panels-container .grid-container").index(t));e(this).find('input[name$="[info][cell]"]').val(t.find(".cell").index(e(this).closest(".cell")))});e("#panels-container .cell").each(function(){e(this).find('input[name$="[grid]"]').val(e("#panels-container .grid-container").index(e(this).closest(".grid-container")))})})};panels.clearGrids=function(){e("#panels-container .grid-container").remove()}})(jQuery);jQuery(function(e){e("#grid-prebuilt-dialog").show().dialog({dialogClass:"panels-admin-dialog",autoOpen:!1,resizable:!1,draggable:!1,modal:!1,title:e("#grid-prebuilt-dialog").attr("data-title"),minWidth:600,height:450,create:function(e,t){},open:function(){var t=e('<div class="siteorigin-panels-ui-widget-overlay ui-widget-overlay ui-front"></div>').css("z-index",80001);e(this).data("overlay",t).closest(".ui-dialog").before(t);e("#grid-prebuilt-dialog").find("select").chosen({disable_search_threshold:8,search_contains:!0,placeholder_text:e("#grid-prebuilt-dialog").find("select").attr("placeholder")})},close:function(){e(this).data("overlay").remove()},buttons:[{text:panels.i10n.buttons.insert,click:function(){var t=e(this).closest(".ui-dialog");if(t.hasClass("panels-ajax-loading"))return;t.addClass("panels-ajax-loading");var n=e("#grid-prebuilt-input").find(":selected");if(n.attr("data-layout-id")==null){e("#grid-prebuilt-dialog").dialog("close");return}e.get(ajaxurl,{action:"so_panels_prebuilt",layout:n.attr("data-layout-id")},function(n){t.removeClass("panels-ajax-loading");if(typeof n.name!="undefined"&&confirm(panels.i10n.messages.confirmLayout)){panels.clearGrids();panels.loadPanels(n);e("#grid-prebuilt-dialog").dialog("close")}})}}]});e("#add-to-panels .prebuilt-set").button({icons:{primary:"ui-icon-prebuilt"},text:!1}).click(function(){e("#grid-prebuilt-dialog").dialog("open");return!1})});jQuery(function(e){e("body").on({mouseenter:function(){e(this).showTooltip()},mouseleave:function(){e(this).removeTooltip()}},"*[data-tooltip]");e.fn.showTooltip=function(){this.each(function(){var t=e(this),n=e('<div class="panels-tooltip"></div>').appendTo("body").html(t.attr("data-tooltip")).append(e('<div class="pointer"></div>'));n.css({top:t.offset().top-12-t.outerHeight(),left:t.offset().left-n.outerWidth()/2+t.outerWidth()/2});panels.animations&&n.hide().fadeIn(100);t.data("tooltip",n)});return this};e.fn.removeTooltip=function(){this.each(function(){var t=e(this),n=t.data("tooltip");if(n!=undefined){t.data("tooltip",undefined);panels.animations?n.fadeOut(100,function(){n.remove()}):n.remove()}});return this}});jQuery(function(e){if(typeof wp=="undefined"||!wp.media||!wp.media.editor)return;var t=wp.media.editor.insert;wp.media.editor.insert=function(n){if(!e("#wp-content-wrap").hasClass("panels-active"))return t(n);if(e(".panel-dialog:visible").length>0)return t(n);if(n.indexOf("[gallery")!==-1){var r=wp.media.gallery.attachments(wp.shortcode.next("gallery",n).shortcode),i=r.models.map(function(e){return e.id}),s=e("#panels-dialog").panelsCreatePanel("SiteOrigin_Panels_Widgets_Gallery",{ids:i.join(",")});s==null?t(n):panels.addPanel(s,null,null,!0);return}if(n.indexOf("<a ")!==-1||n.indexOf("<img ")!==-1){var o=e(n),s;o.prop("tagName")=="A"&&o.children().eq(0).prop("tagName")=="IMG"?s=e("#panels-dialog").panelsCreatePanel("SiteOrigin_Panels_Widgets_Image",{href:o.attr("href"),src:o.children().eq(0).attr("src")}):o.prop("tagName")=="IMG"?s=e("#panels-dialog").panelsCreatePanel("SiteOrigin_Panels_Widgets_Image",{src:o.attr("src")}):o.prop("tagName")=="A"&&(o.attr("href").indexOf(".mp4")!==-1||o.attr("href").indexOf(".avi")!==-1)&&(s=e("#panels-dialog").panelsCreatePanel("SiteOrigin_Panels_Widgets_Video",{url:o.attr("href")}));s==null?t(n):panels.addPanel(s,null,null,!0);return}var s=e("#panels-dialog").panelsCreatePanel("WP_Widget_Text",{text:n});s==null?t(n):panels.addPanel(s,null,null,!0);t(n)}});jQuery(function(e){e("body").on({click:function(t){if(typeof wp=="undefined"||!wp.media||!wp.media.gallery)return;t.preventDefault();var n=e(this),r=e(".panels-admin-dialog:visible"),i=r.find('*[name$="[ids]"]').val();if(i.indexOf("{demo")===0||i.indexOf("{default")===0)i="-";i==""&&e("#post_ID").val()==null&&(i="-");var s=wp.media.gallery.edit('[gallery ids="'+i+'"]');s.state("gallery-edit").on("update",function(e){var t=e.models.map(function(e){return e.id});r.find('input[name$="[ids]"]').val(t.join(","))});s.on("escape",function(){r.find(".ui-dialog-content").dialog("open")});return!1}},".so-gallery-widget-select-attachments")});jQuery(function(e){var t={};t[panels.i10n.buttons.done]=function(){e("#grid-styles-dialog").dialog("close")};e("#grid-styles-dialog").data("html",e("#grid-styles-dialog").html());e("#grid-styles-dialog").show().dialog({dialogClass:"panels-admin-dialog",autoOpen:!1,modal:!1,draggable:!1,resizable:!1,title:e("#grid-styles-dialog").attr("data-title"),maxHeight:Math.round(e(window).height()*.8),width:500,open:function(){var t=e('<div class="siteorigin-panels ui-widget-overlay ui-widget-overlay ui-front"></div>').css("z-index",80001);e(this).data("overlay",t).closest(".ui-dialog").before(t)},close:function(){e(this).data("overlay").remove();var t=e("#grid-styles-dialog").data("container");e("#grid-styles-dialog [data-style-field]").each(function(){var n=e(this),r=t.find('[data-style-field="'+n.data("style-field")+'"]');switch(n.data("style-field-type")){case"checkbox":r.val(n.is(":checked")?"true":"");break;default:r.val(n.val())}})},buttons:t});panels.loadStyleValues=function(t){e("#grid-styles-dialog").data("container",t).html(e("#grid-styles-dialog").data("html"));t.find("[data-style-field]").each(function(){var t=e(this),n=e('#grid-styles-dialog [data-style-field="'+t.data("style-field")+'"]');switch(n.data("style-field-type")){case"checkbox":n.attr("checked",t.val()?!0:!1);break;default:n.val(t.val())}});e("#grid-styles-dialog").dialog("open");panels.colorField();panels.imageField()};panels.colorField=function(){e('#grid-styles-dialog [data-style-field-type="color"]').wpColorPicker().closest("p").find("a").click(function(){e("#grid-styles-dialog").dialog("option","position","center")})};panels.imageField=function(){var t;e("#grid-styles-dialog").on("click",'[data-style-field-type="image"]',function(n){n.preventDefault();var r=e(this).attr("name");if(t){t.open();return}t=wp.media({title:"Select Image",multiple:!1,frame:"select",library:{type:"image"},button:{text:"add image"}});t.on("select",function(){var n=t.state().get("selection");n.each(function(n){console.log(n);var i=t.state().get("selection").first().toJSON();e('input[name="'+r+'"]').val(i.url)})});t.open()})}});jQuery(function(e){console.log("panels.all.min.js loaded")});