/*
 LICENSE

 The MIT License

 Copyright (c) 2010-2012 Arthur Clemens, arthur@visiblearea.com

 Permission is hereby granted, free of charge, to any person obtaining a copy
 of this software and associated documentation files (the "Software"), to deal
 in the Software without restriction, including without limitation the rights
 to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 copies of the Software, and to permit persons to whom the Software is
 furnished to do so, subject to the following conditions: 

 The above copyright notice and this permission notice shall be included in
 all copies or substantial portions of the Software.

 THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 THE SOFTWARE.
 */var UndoManager=function(){"use strict";function i(e){if(!e)return;n=!0;e.f.apply(e.o,e.p);n=!1}function s(e,t,n,r,i,s,o,u){return{undo:{o:e,f:t,p:n,m:r},redo:{o:i,f:s,p:o,m:u}}}var e=[],t=-1,n=!1,r;return{register:function(i,o,u,a,f,l,c,h){if(n)return;e.splice(t+1,e.length-t);e.push(s(i,o,u,a,f,l,c,h));t=e.length-1;r&&r()},setCallback:function(e){r=e},undo:function(){var n=e[t];if(!n)return;i(n.undo);t-=1;r&&r()},redo:function(){var n=e[t+1];if(!n)return;i(n.redo);t+=1;r&&r()},clear:function(){var n=e.length;e=[];t=-1;r&&n>0&&r()},hasUndo:function(){return t!==-1},hasRedo:function(){return t<e.length-1}}};(function(){var e,t,n,r,i,s={}.hasOwnProperty,o=function(e,t){function r(){this.constructor=e}for(var n in t)s.call(t,n)&&(e[n]=t[n]);r.prototype=t.prototype;e.prototype=new r;e.__super__=t.prototype;return e};r=function(){function e(){this.options_index=0;this.parsed=[]}e.prototype.add_node=function(e){return e.nodeName.toUpperCase()==="OPTGROUP"?this.add_group(e):this.add_option(e)};e.prototype.add_group=function(e){var t,n,r,i,s,o;t=this.parsed.length;this.parsed.push({array_index:t,group:!0,label:this.escapeExpression(e.label),children:0,disabled:e.disabled});s=e.childNodes;o=[];for(r=0,i=s.length;r<i;r++){n=s[r];o.push(this.add_option(n,t,e.disabled))}return o};e.prototype.add_option=function(e,t,n){if(e.nodeName.toUpperCase()==="OPTION"){if(e.text!==""){t!=null&&(this.parsed[t].children+=1);this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:e.value,text:e.text,html:e.innerHTML,selected:e.selected,disabled:n===!0?n:e.disabled,group_array_index:t,classes:e.className,style:e.style.cssText})}else this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0});return this.options_index+=1}};e.prototype.escapeExpression=function(e){var t,n;if(e==null||e===!1)return"";if(!/[\&\<\>\"\'\`]/.test(e))return e;t={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};n=/&(?!\w+;)|[\<\>\"\'\`]/g;return e.replace(n,function(e){return t[e]||"&amp;"})};return e}();r.select_to_array=function(e){var t,n,i,s,o;n=new r;o=e.childNodes;for(i=0,s=o.length;i<s;i++){t=o[i];n.add_node(t)}return n.parsed};t=function(){function e(t,n){this.form_field=t;this.options=n!=null?n:{};if(!e.browser_is_supported())return;this.is_multiple=this.form_field.multiple;this.set_default_text();this.set_default_values();this.setup();this.set_up_html();this.register_observers()}e.prototype.set_default_values=function(){var e=this;this.click_test_action=function(t){return e.test_active_click(t)};this.activate_action=function(t){return e.activate_field(t)};this.active_field=!1;this.mouse_on_container=!1;this.results_showing=!1;this.result_highlighted=null;this.allow_single_deselect=this.options.allow_single_deselect!=null&&this.form_field.options[0]!=null&&this.form_field.options[0].text===""?this.options.allow_single_deselect:!1;this.disable_search_threshold=this.options.disable_search_threshold||0;this.disable_search=this.options.disable_search||!1;this.enable_split_word_search=this.options.enable_split_word_search!=null?this.options.enable_split_word_search:!0;this.group_search=this.options.group_search!=null?this.options.group_search:!0;this.search_contains=this.options.search_contains||!1;this.single_backstroke_delete=this.options.single_backstroke_delete!=null?this.options.single_backstroke_delete:!0;this.max_selected_options=this.options.max_selected_options||Infinity;this.inherit_select_classes=this.options.inherit_select_classes||!1;this.display_selected_options=this.options.display_selected_options!=null?this.options.display_selected_options:!0;return this.display_disabled_options=this.options.display_disabled_options!=null?this.options.display_disabled_options:!0};e.prototype.set_default_text=function(){this.form_field.getAttribute("data-placeholder")?this.default_text=this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||e.default_multiple_text:this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||e.default_single_text;return this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||e.default_no_result_text};e.prototype.mouse_enter=function(){return this.mouse_on_container=!0};e.prototype.mouse_leave=function(){return this.mouse_on_container=!1};e.prototype.input_focus=function(e){var t=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return t.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()};e.prototype.input_blur=function(e){var t=this;if(!this.mouse_on_container){this.active_field=!1;return setTimeout(function(){return t.blur_test()},100)}};e.prototype.results_option_build=function(e){var t,n,r,i,s;t="";s=this.results_data;for(r=0,i=s.length;r<i;r++){n=s[r];n.group?t+=this.result_add_group(n):t+=this.result_add_option(n);if(e!=null?e.first:void 0)n.selected&&this.is_multiple?this.choice_build(n):n.selected&&!this.is_multiple&&this.single_set_selected_text(n.text)}return t};e.prototype.result_add_option=function(e){var t,n;if(!e.search_match)return"";if(!this.include_option_in_results(e))return"";t=[];!e.disabled&&(!e.selected||!this.is_multiple)&&t.push("active-result");e.disabled&&(!e.selected||!this.is_multiple)&&t.push("disabled-result");e.selected&&t.push("result-selected");e.group_array_index!=null&&t.push("group-option");e.classes!==""&&t.push(e.classes);n=document.createElement("li");n.className=t.join(" ");n.style.cssText=e.style;n.setAttribute("data-option-array-index",e.array_index);n.innerHTML=e.search_text;return this.outerHTML(n)};e.prototype.result_add_group=function(e){var t;if(!e.search_match&&!e.group_match)return"";if(e.active_options>0){t=document.createElement("li");t.className="group-result";t.innerHTML=e.search_text;return this.outerHTML(t)}return""};e.prototype.results_update_field=function(){this.set_default_text();this.is_multiple||this.results_reset_cleanup();this.result_clear_highlight();this.results_build();if(this.results_showing)return this.winnow_results()};e.prototype.reset_single_select_options=function(){var e,t,n,r,i;r=this.results_data;i=[];for(t=0,n=r.length;t<n;t++){e=r[t];e.selected?i.push(e.selected=!1):i.push(void 0)}return i};e.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()};e.prototype.results_search=function(e){return this.results_showing?this.winnow_results():this.results_show()};e.prototype.winnow_results=function(){var e,t,n,r,i,s,o,u,a,f,l,c,h;this.no_results_clear();i=0;o=this.get_search_text();e=o.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&");r=this.search_contains?"":"^";n=new RegExp(r+e,"i");f=new RegExp(e,"i");h=this.results_data;for(l=0,c=h.length;l<c;l++){t=h[l];t.search_match=!1;s=null;if(this.include_option_in_results(t)){if(t.group){t.group_match=!1;t.active_options=0}if(t.group_array_index!=null&&this.results_data[t.group_array_index]){s=this.results_data[t.group_array_index];s.active_options===0&&s.search_match&&(i+=1);s.active_options+=1}if(!t.group||!!this.group_search){t.search_text=t.group?t.label:t.html;t.search_match=this.search_string_match(t.search_text,n);t.search_match&&!t.group&&(i+=1);if(t.search_match){if(o.length){u=t.search_text.search(f);a=t.search_text.substr(0,u+o.length)+"</em>"+t.search_text.substr(u+o.length);t.search_text=a.substr(0,u)+"<em>"+a.substr(u)}s!=null&&(s.group_match=!0)}else t.group_array_index!=null&&this.results_data[t.group_array_index].search_match&&(t.search_match=!0)}}}this.result_clear_highlight();if(i<1&&o.length){this.update_results_content("");return this.no_results(o)}this.update_results_content(this.results_option_build());return this.winnow_results_set_highlight()};e.prototype.search_string_match=function(e,t){var n,r,i,s;if(t.test(e))return!0;if(this.enable_split_word_search&&(e.indexOf(" ")>=0||e.indexOf("[")===0)){r=e.replace(/\[|\]/g,"").split(" ");if(r.length)for(i=0,s=r.length;i<s;i++){n=r[i];if(t.test(n))return!0}}};e.prototype.choices_count=function(){var e,t,n,r;if(this.selected_option_count!=null)return this.selected_option_count;this.selected_option_count=0;r=this.form_field.options;for(t=0,n=r.length;t<n;t++){e=r[t];e.selected&&(this.selected_option_count+=1)}return this.selected_option_count};e.prototype.choices_click=function(e){e.preventDefault();if(!this.results_showing&&!this.is_disabled)return this.results_show()};e.prototype.keyup_checker=function(e){var t,n;t=(n=e.which)!=null?n:e.keyCode;this.search_field_scale();switch(t){case 8:if(this.is_multiple&&this.backstroke_length<1&&this.choices_count()>0)return this.keydown_backstroke();if(!this.pending_backstroke){this.result_clear_highlight();return this.results_search()}break;case 13:e.preventDefault();if(this.results_showing)return this.result_select(e);break;case 27:this.results_showing&&this.results_hide();return!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}};e.prototype.clipboard_event_checker=function(e){var t=this;return setTimeout(function(){return t.results_search()},50)};e.prototype.container_width=function(){return this.options.width!=null?this.options.width:""+this.form_field.offsetWidth+"px"};e.prototype.include_option_in_results=function(e){return this.is_multiple&&!this.display_selected_options&&e.selected?!1:!this.display_disabled_options&&e.disabled?!1:e.empty?!1:!0};e.prototype.search_results_touchstart=function(e){this.touch_started=!0;return this.search_results_mouseover(e)};e.prototype.search_results_touchmove=function(e){this.touch_started=!1;return this.search_results_mouseout(e)};e.prototype.search_results_touchend=function(e){if(this.touch_started)return this.search_results_mouseup(e)};e.prototype.outerHTML=function(e){var t;if(e.outerHTML)return e.outerHTML;t=document.createElement("div");t.appendChild(e);return t.innerHTML};e.browser_is_supported=function(){return window.navigator.appName==="Microsoft Internet Explorer"?document.documentMode>=8:/iP(od|hone)/i.test(window.navigator.userAgent)?!1:/Android/i.test(window.navigator.userAgent)&&/Mobile/i.test(window.navigator.userAgent)?!1:!0};e.default_multiple_text="Select Some Options";e.default_single_text="Select an Option";e.default_no_result_text="No results match";return e}();e=jQuery;e.fn.extend({chosen:function(r){return t.browser_is_supported()?this.each(function(t){var i,s;i=e(this);s=i.data("chosen");r==="destroy"&&s?s.destroy():s||i.data("chosen",new n(this,r))}):this}});n=function(t){function n(){i=n.__super__.constructor.apply(this,arguments);return i}o(n,t);n.prototype.setup=function(){this.form_field_jq=e(this.form_field);this.current_selectedIndex=this.form_field.selectedIndex;return this.is_rtl=this.form_field_jq.hasClass("chosen-rtl")};n.prototype.set_up_html=function(){var t,n;t=["chosen-container"];t.push("chosen-container-"+(this.is_multiple?"multi":"single"));this.inherit_select_classes&&this.form_field.className&&t.push(this.form_field.className);this.is_rtl&&t.push("chosen-rtl");n={"class":t.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title};this.form_field.id.length&&(n.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen");this.container=e("<div />",n);this.is_multiple?this.container.html('<ul class="chosen-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>'):this.container.html('<a class="chosen-single chosen-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>');this.form_field_jq.hide().after(this.container);this.dropdown=this.container.find("div.chosen-drop").first();this.search_field=this.container.find("input").first();this.search_results=this.container.find("ul.chosen-results").first();this.search_field_scale();this.search_no_results=this.container.find("li.no-results").first();if(this.is_multiple){this.search_choices=this.container.find("ul.chosen-choices").first();this.search_container=this.container.find("li.search-field").first()}else{this.search_container=this.container.find("div.chosen-search").first();this.selected_item=this.container.find(".chosen-single").first()}this.results_build();this.set_tab_index();this.set_label_behavior();return this.form_field_jq.trigger("chosen:ready",{chosen:this})};n.prototype.register_observers=function(){var e=this;this.container.bind("mousedown.chosen",function(t){e.container_mousedown(t)});this.container.bind("mouseup.chosen",function(t){e.container_mouseup(t)});this.container.bind("mouseenter.chosen",function(t){e.mouse_enter(t)});this.container.bind("mouseleave.chosen",function(t){e.mouse_leave(t)});this.search_results.bind("mouseup.chosen",function(t){e.search_results_mouseup(t)});this.search_results.bind("mouseover.chosen",function(t){e.search_results_mouseover(t)});this.search_results.bind("mouseout.chosen",function(t){e.search_results_mouseout(t)});this.search_results.bind("mousewheel.chosen DOMMouseScroll.chosen",function(t){e.search_results_mousewheel(t)});this.search_results.bind("touchstart.chosen",function(t){e.search_results_touchstart(t)});this.search_results.bind("touchmove.chosen",function(t){e.search_results_touchmove(t)});this.search_results.bind("touchend.chosen",function(t){e.search_results_touchend(t)});this.form_field_jq.bind("chosen:updated.chosen",function(t){e.results_update_field(t)});this.form_field_jq.bind("chosen:activate.chosen",function(t){e.activate_field(t)});this.form_field_jq.bind("chosen:open.chosen",function(t){e.container_mousedown(t)});this.form_field_jq.bind("chosen:close.chosen",function(t){e.input_blur(t)});this.search_field.bind("blur.chosen",function(t){e.input_blur(t)});this.search_field.bind("keyup.chosen",function(t){e.keyup_checker(t)});this.search_field.bind("keydown.chosen",function(t){e.keydown_checker(t)});this.search_field.bind("focus.chosen",function(t){e.input_focus(t)});this.search_field.bind("cut.chosen",function(t){e.clipboard_event_checker(t)});this.search_field.bind("paste.chosen",function(t){e.clipboard_event_checker(t)});return this.is_multiple?this.search_choices.bind("click.chosen",function(t){e.choices_click(t)}):this.container.bind("click.chosen",function(e){e.preventDefault()})};n.prototype.destroy=function(){e(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action);this.search_field[0].tabIndex&&(this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex);this.container.remove();this.form_field_jq.removeData("chosen");return this.form_field_jq.show()};n.prototype.search_field_disabled=function(){this.is_disabled=this.form_field_jq[0].disabled;if(this.is_disabled){this.container.addClass("chosen-disabled");this.search_field[0].disabled=!0;this.is_multiple||this.selected_item.unbind("focus.chosen",this.activate_action);return this.close_field()}this.container.removeClass("chosen-disabled");this.search_field[0].disabled=!1;if(!this.is_multiple)return this.selected_item.bind("focus.chosen",this.activate_action)};n.prototype.container_mousedown=function(t){if(!this.is_disabled){t&&t.type==="mousedown"&&!this.results_showing&&t.preventDefault();if(t==null||!e(t.target).hasClass("search-choice-close")){if(!this.active_field){this.is_multiple&&this.search_field.val("");e(this.container[0].ownerDocument).bind("click.chosen",this.click_test_action);this.results_show()}else if(!this.is_multiple&&t&&(e(t.target)[0]===this.selected_item[0]||e(t.target).parents("a.chosen-single").length)){t.preventDefault();this.results_toggle()}return this.activate_field()}}};n.prototype.container_mouseup=function(e){if(e.target.nodeName==="ABBR"&&!this.is_disabled)return this.results_reset(e)};n.prototype.search_results_mousewheel=function(e){var t;e.originalEvent&&(t=-e.originalEvent.wheelDelta||e.originalEvent.detail);if(t!=null){e.preventDefault();e.type==="DOMMouseScroll"&&(t*=40);return this.search_results.scrollTop(t+this.search_results.scrollTop())}};n.prototype.blur_test=function(e){if(!this.active_field&&this.container.hasClass("chosen-container-active"))return this.close_field()};n.prototype.close_field=function(){e(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action);this.active_field=!1;this.results_hide();this.container.removeClass("chosen-container-active");this.clear_backstroke();this.show_search_field_default();return this.search_field_scale()};n.prototype.activate_field=function(){this.container.addClass("chosen-container-active");this.active_field=!0;this.search_field.val(this.search_field.val());return this.search_field.focus()};n.prototype.test_active_click=function(t){var n;n=e(t.target).closest(".chosen-container");return n.length&&this.container[0]===n[0]?this.active_field=!0:this.close_field()};n.prototype.results_build=function(){this.parsing=!0;this.selected_option_count=null;this.results_data=r.select_to_array(this.form_field);if(this.is_multiple)this.search_choices.find("li.search-choice").remove();else if(!this.is_multiple){this.single_set_selected_text();if(this.disable_search||this.form_field.options.length<=this.disable_search_threshold){this.search_field[0].readOnly=!0;this.container.addClass("chosen-container-single-nosearch")}else{this.search_field[0].readOnly=!1;this.container.removeClass("chosen-container-single-nosearch")}}this.update_results_content(this.results_option_build({first:!0}));this.search_field_disabled();this.show_search_field_default();this.search_field_scale();return this.parsing=!1};n.prototype.result_do_highlight=function(e){var t,n,r,i,s;if(e.length){this.result_clear_highlight();this.result_highlight=e;this.result_highlight.addClass("highlighted");r=parseInt(this.search_results.css("maxHeight"),10);s=this.search_results.scrollTop();i=r+s;n=this.result_highlight.position().top+this.search_results.scrollTop();t=n+this.result_highlight.outerHeight();if(t>=i)return this.search_results.scrollTop(t-r>0?t-r:0);if(n<s)return this.search_results.scrollTop(n)}};n.prototype.result_clear_highlight=function(){this.result_highlight&&this.result_highlight.removeClass("highlighted");return this.result_highlight=null};n.prototype.results_show=function(){if(this.is_multiple&&this.max_selected_options<=this.choices_count()){this.form_field_jq.trigger("chosen:maxselected",{chosen:this});return!1}this.container.addClass("chosen-with-drop");this.results_showing=!0;this.search_field.focus();this.search_field.val(this.search_field.val());this.winnow_results();return this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this})};n.prototype.update_results_content=function(e){return this.search_results.html(e)};n.prototype.results_hide=function(){if(this.results_showing){this.result_clear_highlight();this.container.removeClass("chosen-with-drop");this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this})}return this.results_showing=!1};n.prototype.set_tab_index=function(e){var t;if(this.form_field.tabIndex){t=this.form_field.tabIndex;this.form_field.tabIndex=-1;return this.search_field[0].tabIndex=t}};n.prototype.set_label_behavior=function(){var t=this;this.form_field_label=this.form_field_jq.parents("label");!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=e("label[for='"+this.form_field.id+"']"));if(this.form_field_label.length>0)return this.form_field_label.bind("click.chosen",function(e){return t.is_multiple?t.container_mousedown(e):t.activate_field()})};n.prototype.show_search_field_default=function(){if(this.is_multiple&&this.choices_count()<1&&!this.active_field){this.search_field.val(this.default_text);return this.search_field.addClass("default")}this.search_field.val("");return this.search_field.removeClass("default")};n.prototype.search_results_mouseup=function(t){var n;n=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first();if(n.length){this.result_highlight=n;this.result_select(t);return this.search_field.focus()}};n.prototype.search_results_mouseover=function(t){var n;n=e(t.target).hasClass("active-result")?e(t.target):e(t.target).parents(".active-result").first();if(n)return this.result_do_highlight(n)};n.prototype.search_results_mouseout=function(t){if(e(t.target).hasClass("active-result"))return this.result_clear_highlight()};n.prototype.choice_build=function(t){var n,r,i=this;n=e("<li />",{"class":"search-choice"}).html("<span>"+t.html+"</span>");if(t.disabled)n.addClass("search-choice-disabled");else{r=e("<a />",{"class":"search-choice-close","data-option-array-index":t.array_index});r.bind("click.chosen",function(e){return i.choice_destroy_link_click(e)});n.append(r)}return this.search_container.before(n)};n.prototype.choice_destroy_link_click=function(t){t.preventDefault();t.stopPropagation();if(!this.is_disabled)return this.choice_destroy(e(t.target))};n.prototype.choice_destroy=function(e){if(this.result_deselect(e[0].getAttribute("data-option-array-index"))){this.show_search_field_default();this.is_multiple&&this.choices_count()>0&&this.search_field.val().length<1&&this.results_hide();e.parents("li").first().remove();return this.search_field_scale()}};n.prototype.results_reset=function(){this.reset_single_select_options();this.form_field.options[0].selected=!0;this.single_set_selected_text();this.show_search_field_default();this.results_reset_cleanup();this.form_field_jq.trigger("change");if(this.active_field)return this.results_hide()};n.prototype.results_reset_cleanup=function(){this.current_selectedIndex=this.form_field.selectedIndex;return this.selected_item.find("abbr").remove()};n.prototype.result_select=function(e){var t,n;if(this.result_highlight){t=this.result_highlight;this.result_clear_highlight();if(this.is_multiple&&this.max_selected_options<=this.choices_count()){this.form_field_jq.trigger("chosen:maxselected",{chosen:this});return!1}this.is_multiple?t.removeClass("active-result"):this.reset_single_select_options();n=this.results_data[t[0].getAttribute("data-option-array-index")];n.selected=!0;this.form_field.options[n.options_index].selected=!0;this.selected_option_count=null;this.is_multiple?this.choice_build(n):this.single_set_selected_text(n.text);(!e.metaKey&&!e.ctrlKey||!this.is_multiple)&&this.results_hide();this.search_field.val("");(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[n.options_index].value});this.current_selectedIndex=this.form_field.selectedIndex;return this.search_field_scale()}};n.prototype.single_set_selected_text=function(e){e==null&&(e=this.default_text);if(e===this.default_text)this.selected_item.addClass("chosen-default");else{this.single_deselect_control_build();this.selected_item.removeClass("chosen-default")}return this.selected_item.find("span").text(e)};n.prototype.result_deselect=function(e){var t;t=this.results_data[e];if(!this.form_field.options[t.options_index].disabled){t.selected=!1;this.form_field.options[t.options_index].selected=!1;this.selected_option_count=null;this.result_clear_highlight();this.results_showing&&this.winnow_results();this.form_field_jq.trigger("change",{deselected:this.form_field.options[t.options_index].value});this.search_field_scale();return!0}return!1};n.prototype.single_deselect_control_build=function(){if(!this.allow_single_deselect)return;this.selected_item.find("abbr").length||this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>');return this.selected_item.addClass("chosen-single-with-deselect")};n.prototype.get_search_text=function(){return this.search_field.val()===this.default_text?"":e("<div/>").text(e.trim(this.search_field.val())).html()};n.prototype.winnow_results_set_highlight=function(){var e,t;t=this.is_multiple?[]:this.search_results.find(".result-selected.active-result");e=t.length?t.first():this.search_results.find(".active-result").first();if(e!=null)return this.result_do_highlight(e)};n.prototype.no_results=function(t){var n;n=e('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>');n.find("span").first().html(t);this.search_results.append(n);return this.form_field_jq.trigger("chosen:no_results",{chosen:this})};n.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()};n.prototype.keydown_arrow=function(){var e;if(!this.results_showing||!this.result_highlight)return this.results_show();e=this.result_highlight.nextAll("li.active-result").first();if(e)return this.result_do_highlight(e)};n.prototype.keyup_arrow=function(){var e;if(!this.results_showing&&!this.is_multiple)return this.results_show();if(this.result_highlight){e=this.result_highlight.prevAll("li.active-result");if(e.length)return this.result_do_highlight(e.first());this.choices_count()>0&&this.results_hide();return this.result_clear_highlight()}};n.prototype.keydown_backstroke=function(){var e;if(this.pending_backstroke){this.choice_destroy(this.pending_backstroke.find("a").first());return this.clear_backstroke()}e=this.search_container.siblings("li.search-choice").last();if(e.length&&!e.hasClass("search-choice-disabled")){this.pending_backstroke=e;return this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")}};n.prototype.clear_backstroke=function(){this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus");return this.pending_backstroke=null};n.prototype.keydown_checker=function(e){var t,n;t=(n=e.which)!=null?n:e.keyCode;this.search_field_scale();t!==8&&this.pending_backstroke&&this.clear_backstroke();switch(t){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(e);this.mouse_on_container=!1;break;case 13:e.preventDefault();break;case 38:e.preventDefault();this.keyup_arrow();break;case 40:e.preventDefault();this.keydown_arrow()}};n.prototype.search_field_scale=function(){var t,n,r,i,s,o,u,a,f;if(this.is_multiple){r=0;u=0;s="position:absolute; left: -1000px; top: -1000px; display:none;";o=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"];for(a=0,f=o.length;a<f;a++){i=o[a];s+=i+":"+this.search_field.css(i)+";"}t=e("<div />",{style:s});t.text(this.search_field.val());e("body").append(t);u=t.width()+25;t.remove();n=this.container.outerWidth();u>n-10&&(u=n-10);return this.search_field.css({width:u+"px"})}};return n}(t)}).call(this);jQuery(function(e){panels.animations=e("#panels").data("animations");e(window).bind("resize",function(t){if(e(t.target).hasClass("ui-resizable"))return;e("#panels-container .grid-container").panelsResizeCells()});e("#panels-container").sortable({items:"> .grid-container",handle:".grid-handle",tolerance:"pointer",stop:function(){e(this).find(".cell").each(function(){e(this).find('input[name$="[grid]"]').val(e("#panels-container .grid-container").index(e(this).closest(".grid-container")))});e("#panels-container .panels-container").trigger("refreshcells")}});var t={};t[panels.i10n.buttons.add]=function(){var t=Number(e("#grid-add-dialog").find("input").val());if(isNaN(t)){alert("Invalid Number");return!1}t=Math.min(10,Math.max(1,Math.round(t)));var n=window.panels.createGrid(t);panels.animations?n.hide().slideDown():n.show();e("#grid-add-dialog").dialog("close")};e("#grid-add-dialog").show().dialog({dialogClass:"panels-admin-dialog",autoOpen:!1,modal:!1,title:e("#grid-add-dialog").attr("data-title"),open:function(){e(this).find("input").val(2).select();var t=e('<div class="siteorigin-panels ui-widget-overlay ui-widget-overlay ui-front"></div>').css("z-index",80001);e(this).data("overlay",t).closest(".ui-dialog").before(t)},close:function(){e(this).data("overlay").remove()},buttons:t}).on("keydown",function(n){if(n.keyCode==e.ui.keyCode.ENTER){t[panels.i10n.buttons.add]();setTimeout(function(){e("#grid-add-dialog").dialog("close")},1)}else n.keyCode===e.ui.keyCode.ESCAPE&&e("#grid-add-dialog").dialog("close")});e("#panels-dialog").show().dialog({dialogClass:"panels-admin-dialog",autoOpen:!1,resizable:!1,draggable:!1,modal:!1,title:e("#panels-dialog").attr("data-title"),minWidth:960,maxHeight:Math.round(e(window).height()*.8),open:function(){var t=e('<div class="siteorigin-panels-ui-widget-overlay ui-widget-overlay ui-front"></div>').css("z-index",80001);e(this).data("overlay",t).closest(".ui-dialog").before(t)},close:function(){e(this).data("overlay").remove();panels.animations?e("#panels-container .panel.new-panel").hide().slideDown(1e3).removeClass("new-panel"):e("#panels-container .panel.new-panel").show().removeClass("new-panel")}}).on("keydown",function(t){t.keyCode===e.ui.keyCode.ESCAPE&&e(this).dialog("close")});e("#so-panels-panels .handlediv").click(function(){setTimeout(function(){e(window).resize()},150)});e("#panels .panels-add").button({icons:{primary:"ui-icon-add"},text:!1}).click(function(){e("#panels-text-filter-input").val("").keyup();e("#panels-dialog").dialog("open");return!1});e("#panels .grid-add").button({icons:{primary:"ui-icon-columns"},text:!1}).click(function(){e("#grid-add-dialog").dialog("open");return!1});e("#siteorigin-widgets-link").data("text",e("#siteorigin-widgets-link").html());e("#panels-text-filter-input").keyup(function(t){if(t.keyCode==13){var n=e("#panels-dialog .panel-type-list .panel-type:visible");n.length==1&&n.click();return}var r=e(this).val().toLowerCase();e("#panels-dialog .panel-type-list .panel-type").show().each(function(){if(r=="")return;e(this).find("h3").html().toLowerCase().indexOf(r)==-1&&e(this).hide()})}).click(function(){e(this).keyup()});e("#panels-dialog .panel-type").click(function(){var t=e("#panels-dialog").panelsCreatePanel(e(this).attr("data-class"));panels.addPanel(t,null,null,!0);e("#panels-dialog").dialog("close")});typeof panelsData!="undefined"?panels.loadPanels(panelsData):panels.createGrid(1);e(window).resize(function(){e(".panels-admin-dialog").filter(":data(dialog)").dialog("option","position","center")});e("#wp-content-editor-tools").find(".wp-switch-editor").click(function(){var t=e(this);e("#wp-content-editor-container, #post-status-info").show();e("#so-panels-panels").hide();e("#wp-content-wrap").removeClass("panels-active");e("#content-resize-handle").show()}).end().prepend(e('<a id="content-panels" class="hide-if-no-js wp-switch-editor switch-panels">'+e("#so-panels-panels h3.hndle span").html()+"</a>").click(function(){var t=e(this);e("#wp-content-wrap").removeClass("tmce-active html-active");e("#wp-content-editor-container, #post-status-info").hide();e("#so-panels-panels").show().find("> .inside").show();e("#wp-content-wrap").addClass("panels-active");e(window).resize();e("#content-resize-handle").hide();return!1}));e("#wp-content-editor-tools .wp-switch-editor").click(function(){var t=e(this),n=t.attr("id").split("-");e("#wp-content-wrap").addClass(n[1]+"-active")});e("#panels-home-page #post-body").show();e("#panels-home-page #post-body-wrapper").css("background","none");e("#so-panels-panels").insertAfter("#wp-content-editor-container").addClass("wp-editor-container").hide().find(".handlediv").remove().end().find(".hndle").html("").append(e("#add-to-panels"));e("#content-panels").click(function(){e(window).resize()});(typeof panelsData!="undefined"||e("#panels-home-page"
).length)&&e("#content-panels").click();setTimeout(function(){(typeof panelsData!="undefined"||e("#panels-home-page").length)&&e("#content-panels").click();e("#so-panels-panels .hndle").unbind("click");e("#so-panels-panels .cell").eq(0).click()},150);if(e("#panels-home-page").length){e("#content-tmce, #content-html").remove();e("#content-panels").hide();e("#panels-toggle-switch").mouseenter(function(){e(this).addClass("subtle-move")}).click(function(){e(this).toggleClass("state-off").toggleClass("state-on").removeClass("subtle-move");e("#panels-home-enabled").val(e(this).hasClass("state-off")?"false":"true")});e("#post-preview").click(function(t){var n=e("#panels-container").closest("form"),r=n.attr("action");n.attr("action",panels.previewUrl).attr("target","_blank").submit().attr("action",r).attr("target","_self");t.preventDefault()})}e("#panels").append('<input name="panels_js_complete" type="hidden" value="1" />')});(function(e){var t=0;panels.undoManager=new UndoManager;e.fn.panelsGetPanelData=function(){var t=e(this),n={},r;t.data("missing")===!0?n=JSON.parse(t.find('input[name$="[data]"]').val()):typeof t.data("dialog")!="undefined"&&!t.data("dialog").hasClass("ui-dialog-content-loading")?t.data("dialog").find("*[name]").not("[data-info-field]").each(function(){var t=e(this),i=/widgets\[[0-9]+\]\[(.*)\]/.exec(t.attr("name"));i=i[1];r=i.split("][");r=r.map(function(e){return!isNaN(parseFloat(e))&&isFinite(e)?parseInt(e):e});var s=n;for(var o=0;o<r.length;o++)if(o==r.length-1)t.attr("type")=="checkbox"?t.is(":checked")&&(s[r[o]]=t.val()!=""?t.val():!0):s[r[o]]=t.val();else{typeof s[r[o]]=="undefined"&&(s[r[o]]={});s=s[r[o]]}}):t.find('input[name$="[data]"]').val()==""?n={}:n=JSON.parse(t.find('input[name$="[data]"]').val());return n};e.fn.panelsCreatePanel=function(n,r){e("#panels-undo-message").fadeOut(function(){e(this).remove()});var i,s=t++,o=e(this),u=e('<div class="panel new-panel"><div class="panel-wrapper"><div class="title"><h4></h4><span class="actions"></span></div><small class="description"></small></div></div>');u.attr("data-type",n).append(e('<input type="hidden" name="widgets['+s+'][data]" type="hidden">').val(JSON.stringify(r))).append(e('<input type="hidden" name="widgets['+s+'][info][raw]" type="hidden">').val(0)).append(e('<input type="hidden" name="widgets['+s+'][info][grid]" type="hidden">')).append(e('<input type="hidden" name="widgets['+s+'][info][cell]" type="hidden">')).append(e('<input type="hidden" name="widgets['+s+'][info][id]" type="hidden">').val(s)).append(e('<input type="hidden" name="widgets['+s+'][info][class]" type="hidden">').val(n)).append(e('<input type="hidden" name="panel_order[]" type="hidden">').val(s)).data("raw",!1).find("h4, h5").click(function(){e(this).closest(".panel").find("a.edit").click();return!1});var a=o.find(".panel-type").filter(function(){return e(this).data("class")===n});if(a.length!=0)u.data({title:a.data("title")}).find(".description").html(a.find(".description").html()).end().find(".title h4").html(a.find("h3").html());else{if(typeof panelsMissingWidgets=="undefined"||typeof panelsMissingWidgets[n]=="undefined")return;u.data({title:panelsMissingWidgets[n].title,missing:!0}).find(".description").html(panelsMissingWidgets[n].description).end().find(".title h4").html(panelsMissingWidgets[n].title)}u.panelsSetPanelTitle(r);var f=function(){panels.undoManager.register(this,function(t,n,r,i){var s=e("#panels-dialog").panelsCreatePanel(t,n,r);panels.addPanel(s,r,i,!0);e("#panels-container .panel").removeClass("new-panel")},[u.attr("data-type"),u.panelsGetPanelData(),u.closest(".panels-container"),u.index()],"Remove Panel");e("#panels-undo-message").remove();e('<div id="panels-undo-message" class="updated"><p>'+panels.i10n.messages.deleteWidget+' - <a href="#" class="undo">'+panels.i10n.buttons.undo+"</a></p></div>").appendTo("body").hide().slideDown().find("a.undo").click(function(){panels.undoManager.undo();e("#panels-undo-message").fadeOut(function(){e(this).remove()});return!1});var t=function(){var e=u.closest(".grid-container");u.remove();e.panelsResizeCells()};if(panels.animations)u.slideUp(t);else{u.hide();t()}};u.find(".title .actions").append(e("<a>"+panels.i10n.buttons.edit+"<a>").addClass("edit").click(function(){if(typeof i!="undefined")return!1;var t={},r=!1;t[panels.i10n.buttons.done]=function(){r=!0;e(this).trigger("panelsdone",u,i);var t=u.panelsGetPanelData();if(i.find(".panels-missing-widget-form").length==0){u.find('input[name$="[data]"]').val(JSON.stringify(t));u.panelsSetPanelTitle(t);u.find('input[name$="[info][raw]"]').val(1)}i.dialog("close")};i=e('<div class="panel-dialog dialog-form"></div>').data("widget-type",n).addClass("ui-dialog-content-loading").addClass("widget-dialog-"+n.toLowerCase()).dialog({dialogClass:"panels-admin-dialog",autoOpen:!0,modal:!1,draggable:!1,resizable:!1,title:panels.i10n.messages.editWidget.replace("%s",u.data("title")),width:600,height:Math.round(e(window).height()*.875),create:function(t,n){e(this).closest(".ui-dialog").find(".show-in-panels").show()},open:function(){e(this).closest(".ui-dialog").find("a").blur();var t=e('<div class="siteorigin-panels-ui-widget-overlay ui-widget-overlay ui-front"></div>').css("z-index",80001);e(this).data("overlay",t).closest(".ui-dialog").before(t)},close:function(){r||e(this).trigger("panelsdone",u,i);e(this).data("overlay").remove();e(this).dialog("destroy").remove();i=undefined},buttons:t}).keypress(function(t){if(t.keyCode==e.ui.keyCode.ENTER){if(e(this).closest(".ui-dialog").find("textarea:focus").length>0)return;e(this).closest(".ui-dialog").find(".ui-dialog-buttonpane .ui-button:eq(0)").click();t.preventDefault();return!1}t.keyCode===e.ui.keyCode.ESCAPE&&e(this).closest(".ui-dialog").dialog("close")});u.data("dialog",i);var o=n;try{o=o.replace("\\\\","\\")}catch(a){return}e.post(ajaxurl,{action:"so_panels_widget_form",widget:o,instance:JSON.stringify(u.panelsGetPanelData()),raw:u.find('input[name$="[info][raw]"]').val()},function(t){try{t=t.replace(/\{\$id\}/g,s)}catch(n){t=""}i.html(t).dialog("option","position","center");var r=i.find("a.siteorigin-panels-help-link");r.length&&r.attr("target","_blank").prependTo(i.closest(".ui-dialog").find(".ui-dialog-buttonpane"));e(window).resize();e(document).trigger("panelssetup",u,i);e("#panels-container .panels-container").trigger("refreshcells");i.removeClass("ui-dialog-content-loading").trigger("panelsopen",u,i)},"html");return!1})).append(e("<a>"+panels.i10n.buttons.duplicate+"<a>").addClass("duplicate").click(function(){var t=e("#panels-dialog").panelsCreatePanel(u.attr("data-type"),u.panelsGetPanelData());window.panels.addPanel(t,u.closest(".panels-container"),null,!1);t.removeClass("new-panel");return!1})).append(e("<a>"+panels.i10n.buttons.delete+"<a>").addClass("delete").click(function(){f();return!1}));return u};panels.addPanel=function(t,n,r,i){n==null&&(n=e("#panels-container .cell.cell-selected .panels-container").eq(0));n.length==0&&(n=e("#panels-container .cell .panels-container").eq(0));if(n.length==0){panels.createGrid(1,[1]);n=e("#panels-container .cell .panels-container").eq(0)}if(r==null)n.append(t);else{var s=n.find(".panel").eq(r);s.length==0?n.append(t):t.insertBefore(s)}n.sortable("refresh").trigger("refreshcells");n.closest(".grid-container").panelsResizeCells();if(i)if(panels.animations)e("#panels-container .panel.new-panel").hide().slideDown(450,function(){t.find("a.edit").click()}).removeClass("new-panel");else{e("#panels-container .panel.new-panel").show().removeClass("new-panel");t.find("a.edit").click()}};e.fn.panelsSetPanelTitle=function(t){return e(this).each(function(){var n="";if(typeof t!="undefined")if(typeof t.title!="undefined"&&t.title!="")n=t.title;else for(var r in t)if(typeof t[r]=="string"&&t[r]!=""){n=t[r];break}try{n=n.substring(0,80).replace(/(<([^>]+)>)/ig,"")}catch(i){n=""}e(this).find("h4").html(e(this).data("title")+"<span>"+n+"</span>")})};panels.loadPanels=function(t){panels.clearGrids();if(typeof t!="undefined"&&typeof t.grids!="undefined")for(var n in t.grids){var r=[];for(var i in t.grid_cells)Number(t.grid_cells[i]["grid"])==n&&(r[r.length]=Number(t.grid_cells[i].weight));var s=panels.createGrid(Number(t.grids[n].cells),r,t.grids[n].style);for(var o in t.widgets){if(typeof t.widgets[o]["info"]=="undefined")continue;if(Number(t.widgets[o]["info"]["grid"])==n){var u=t.widgets[o],a=e("#panels-dialog").panelsCreatePanel(u.info["class"],u);s.find(".panels-container").eq(Number(t.widgets[o].info.cell)).append(a)}}}e("#panels-container .panels-container").sortable("refresh").trigger("refreshcells");e("#panels-container .panel").removeClass("new-panel");e("#panels-container .grid-container").each(function(){e(this).panelsResizeCells()})}})(jQuery);(function(e){var t=0,n=0;e.fn.panelsResizeCells=function(){return e(this).each(function(){var t=e(this);t.find(".grid, .grid .cell, .grid .cell .cell-wrapper").css("height","auto");var n=t.find(".grid").outerWidth();t.find(".grid .cell").length>1&&t.find(".grid .cell").each(function(){e(this).is(".first, .last")?n-=6:n-=12});var r=0,i=0;t.find(".grid .cell").each(function(){i=Math.max(i,e(this).height());e(this).width(Math.floor(n*Number(e(this).attr("data-percent")))).css("left",r);r+=e(this).width()+12});t.find(".grid, .grid .cell, .grid .cell .cell-wrapper").css("height",Math.max(i,68))})};panels.createGrid=function(r,i,s){if(i==null||i.length==0){i=[];for(var o=0;o<r;o++)i[o]=1}typeof s=="undefined"&&(s={});var u=0;for(var a in i)u+=i[a];var f=e("<div />").addClass("grid-container").appendTo("#panels-container");f.append(e('<input type="hidden" name="grids['+t+'][cells]" />').val(r));var l={};for(var c in panelsStyleFields){l[c]=e('<input type="hidden" name="grids['+t+"][style]["+c+']" data-style-field="'+c+'" />').appendTo(f);typeof s[c]!="undefined"&&(panelsStyleFields[c]["type"]=="checkbox"?l[c].val(s[c]?"true":""):l[c].val(s[c]))}f.append(e('<div class="controls" />').append(e('<div class="ui-button ui-button-icon-only"><div class="ui-icon ui-icon-remove"></div></div>').attr("data-tooltip",panels.i10n.buttons["delete"]).click(function(){e(this).removeTooltip();var t=[];f.find(".cell").each(function(n,r){t[n]={weight:Number(e(this).attr("data-percent")),widgets:[]};e(this).find(".panel").each(function(r,i){t[n].widgets[r]={type:e(this).attr("data-type"),data:e(this).panelsGetPanelData()}})});window.panels.undoManager.register(this,function(t,n){var r=[];for(var i=0;i<t.length;i++)r[i]=t[i].weight;var s=window.panels.createGrid(r.length,r);for(var i=0;i<t.length;i++)for(var o=0;o<t[i].widgets.length;o++){var u=t[i].widgets[o],a=e("#panels-dialog").panelsCreatePanel(u.type,u.data);window.panels.addPanel(a,s.find(".panels-container").eq(i))}if(n!=s.index()){var f=e("#panels-container .grid-container").eq(n);if(f.length){s.insertBefore(f);e("#panels-container").sortable("refresh");e("#panels-container").find(".cell").each(function(){e(this).find('input[name$="[grid]"]').val(e("#panels-container .grid-container").index(e(this).closest(".grid-container")))});e("#panels-container .panels-container").trigger("refreshcells")}}e("#panels-container .panel").removeClass("new-panel");panels.animations?s.hide().slideDown():s.show()},[t,f.index()],"Remove Columns");e("#panels-undo-message").remove();e('<div id="panels-undo-message" class="updated"><p>'+panels.i10n.messages.deleteColumns+' - <a href="#" class="undo">'+panels.i10n.buttons.undo+"</a></p></div>").appendTo("body").hide().fadeIn().find("a.undo").click(function(){window.panels.undoManager.undo();e("#panels-undo-message").fadeOut(function(){e(this).remove()});return!1});var n=function(){f.remove();e("#panels-container").sortable("refresh").find(".panels-container").trigger("refreshcells")};if(panels.animations)f.slideUp(n);else{f.hide();n()}return!1})).append(e('<div class="ui-button ui-button-icon-only panels-visual-style"><div class="ui-icon ui-icon-gear"></div></div>').attr("data-tooltip","Visual Style").click(function(){panels.loadStyleValues(f)})).append(e('<div class="ui-button ui-button-icon-only grid-handle"><div class="ui-icon ui-icon-move"></div></div>')));Object.keys(panelsStyleFields).length||f.find(".panels-visual-style").remove();var h=e("<div />").addClass("grid").appendTo(f);for(var o=0;o<r;o++){var p=e('<div class="cell" data-percent="'+i[o]/u+'">'+'<div class="cell-wrapper panels-container"></div>'+'<div class="cell-width"><div class="cell-width-left"></div><div class="cell-width-right"></div><div class="cell-width-line"></div><div class="cell-width-value"><span></span></div></div>'+"</div>");o==0&&p.addClass("first");o==r-1&&p.addClass("last");h.append(p);p.append(e('<input type="hidden" name="grid_cells['+n+'][weight]" />').val(i[o]/u)).append(e('<input type="hidden" name="grid_cells['+n+'][grid]" />').val(t)).data("cellId",n);n++}h.append(e("<div />").addClass("clear"));t++;panels.setupGrid(f);return f};panels.setupGrid=function(t){e("#panels-undo-message").fadeOut(function(){e(this).remove()});t.panelsResizeCells();t.find(".grid .cell").not(".first").each(function(){var n,r;e(this).resizable({handles:"w",containment:"parent",start:function(t,i){n=e(this).prev().outerWidth();r=e(this).prev().position().left},stop:function(e,n){t.find(".grid .cell").not(".first").resizable("disable").resizable("enable")},resize:function(n,r){var i=e(this),s=e(this).prev();s.css("width",i.position().left-s.position().left-12);var o=0;t.find(".grid .cell").each(function(){o+=e(this).width()}).each(function(){var t=e(this).width()/o;e(this).find(".cell-width-value span").html(Math.round(t*1e3)/10+"%");e(this).attr("data-percent",t).find('input[name$="[weight]"]').val(t)});t.panelsResizeCells()}})});t.find(".grid .cell .ui-resizable-handle").dblclick(function(){var n=e(this).closest(".cell"),r=n.prev(),i=Number(n.attr("data-percent"))+Number(r.attr("data-percent"));n.attr("data-percent",i/2).find('input[name$="[weight]"]').val(i/2);r.attr("data-percent",i/2).find('input[name$="[weight]"]').val(i/2);n.add(r).find(".cell-width-value span").html(Math.round(i/2*1e3)/10+"%");t.panelsResizeCells();return!1});t.find(".grid .cell").click(function(){e(".grid .cell").removeClass("cell-selected");e(this).addClass("cell-selected")}).each(function(){var t=Number(e(this).attr("data-percent"));e(this).find(".cell-width-value span").html(Math.round(t*1e3)/10+"%")}).find(".panels-container").sortable({placeholder:"ui-state-highlight",connectWith:".panels-container",tolerance:"pointer",change:function(t){var n=e("#panels-container .ui-state-highlight").closest(".cell").get(0);if(typeof this.lastContainer!="undefined"&&this.lastContainer!=n){e(this.lastContainer).closest(".grid-container").panelsResizeCells();e(n).closest(".grid-container").panelsResizeCells();n.click()}this.lastContainer=n},helper:function(e,t){return t.clone().css("opacity",panels.animations?.9:1).addClass("panel-being-dragged")},stop:function(t,n){e("#panels-container .grid-container").each(function(){e(this).panelsResizeCells()})},receive:function(){e(this).trigger("refreshcells")}}).bind("refreshcells",function(){e("#panels-container .panel").each(function(){var t=e(this).closest(".grid-container");e(this).find('input[name$="[info][grid]"]').val(e("#panels-container .grid-container").index(t));e(this).find('input[name$="[info][cell]"]').val(t.find(".cell").index(e(this).closest(".cell")))});e("#panels-container .cell").each(function(){e(this).find('input[name$="[grid]"]').val(e("#panels-container .grid-container").index(e(this).closest(".grid-container")))})})};panels.clearGrids=function(){e("#panels-container .grid-container").remove()}})(jQuery);jQuery(function(e){e("#grid-prebuilt-dialog").show().dialog({dialogClass:"panels-admin-dialog",autoOpen:!1,resizable:!1,draggable:!1,modal:!1,title:e("#grid-prebuilt-dialog").attr("data-title"),minWidth:600,height:450,create:function(e,t){},open:function(){var t=e('<div class="siteorigin-panels-ui-widget-overlay ui-widget-overlay ui-front"></div>').css("z-index",80001);e(this).data("overlay",t).closest(".ui-dialog").before(t);e("#grid-prebuilt-dialog").find("select").chosen({disable_search_threshold:8,search_contains:!0,placeholder_text:e("#grid-prebuilt-dialog").find("select").attr("placeholder")})},close:function(){e(this).data("overlay").remove()},buttons:[{text:panels.i10n.buttons.insert,click:function(){var t=e(this).closest(".ui-dialog");if(t.hasClass("panels-ajax-loading"))return;t.addClass("panels-ajax-loading");var n=e("#grid-prebuilt-input").find(":selected");if(n.attr("data-layout-id")==null){e("#grid-prebuilt-dialog").dialog("close");return}e.get(ajaxurl,{action:"so_panels_prebuilt",layout:n.attr("data-layout-id")},function(n){t.removeClass("panels-ajax-loading");if(typeof n.name!="undefined"&&confirm(panels.i10n.messages.confirmLayout)){panels.clearGrids();panels.loadPanels(n);e("#grid-prebuilt-dialog").dialog("close")}})}}]});e("#add-to-panels .prebuilt-set").button({icons:{primary:"ui-icon-prebuilt"},text:!1}).click(function(){e("#grid-prebuilt-dialog").dialog("open");return!1})});jQuery(function(e){e("body").on({mouseenter:function(){e(this).showTooltip()},mouseleave:function(){e(this).removeTooltip()}},"*[data-tooltip]");e.fn.showTooltip=function(){this.each(function(){var t=e(this),n=e('<div class="panels-tooltip"></div>').appendTo("body").html(t.attr("data-tooltip")).append(e('<div class="pointer"></div>'));n.css({top:t.offset().top-12-t.outerHeight(),left:t.offset().left-n.outerWidth()/2+t.outerWidth()/2});panels.animations&&n.hide().fadeIn(100);t.data("tooltip",n)});return this};e.fn.removeTooltip=function(){this.each(function(){var t=e(this),n=t.data("tooltip");if(n!=undefined){t.data("tooltip",undefined);panels.animations?n.fadeOut(100,function(){n.remove()}):n.remove()}});return this}});jQuery(function(e){if(typeof wp=="undefined"||!wp.media||!wp.media.editor)return;var t=wp.media.editor.insert;wp.media.editor.insert=function(n){if(!e("#wp-content-wrap").hasClass("panels-active"))return t(n);if(e(".panel-dialog:visible").length>0)return t(n);if(n.indexOf("[gallery")!==-1){var r=wp.media.gallery.attachments(wp.shortcode.next("gallery",n).shortcode),i=r.models.map(function(e){return e.id}),s=e("#panels-dialog").panelsCreatePanel("SiteOrigin_Panels_Widgets_Gallery",{ids:i.join(",")});s==null?t(n):panels.addPanel(s,null,null,!0);return}if(n.indexOf("<a ")!==-1||n.indexOf("<img ")!==-1){var o=e(n),s;o.prop("tagName")=="A"&&o.children().eq(0).prop("tagName")=="IMG"?s=e("#panels-dialog").panelsCreatePanel("SiteOrigin_Panels_Widgets_Image",{href:o.attr("href"),src:o.children().eq(0).attr("src")}):o.prop("tagName")=="IMG"?s=e("#panels-dialog").panelsCreatePanel("SiteOrigin_Panels_Widgets_Image",{src:o.attr("src")}):o.prop("tagName")=="A"&&(o.attr("href").indexOf(".mp4")!==-1||o.attr("href").indexOf(".avi")!==-1)&&(s=e("#panels-dialog").panelsCreatePanel("SiteOrigin_Panels_Widgets_Video",{url:o.attr("href")}));s==null?t(n):panels.addPanel(s,null,null,!0);return}var s=e("#panels-dialog").panelsCreatePanel("WP_Widget_Text",{text:n});s==null?t(n):panels.addPanel(s,null,null,!0);t(n)}});jQuery(function(e){e("body").on({click:function(t){if(typeof wp=="undefined"||!wp.media||!wp.media.gallery)return;t.preventDefault();var n=e(this),r=e(".panels-admin-dialog:visible"),i=r.find('*[name$="[ids]"]').val();if(i.indexOf("{demo")===0||i.indexOf("{default")===0)i="-";i==""&&e("#post_ID").val()==null&&(i="-");var s=wp.media.gallery.edit('[gallery ids="'+i+'"]');s.state("gallery-edit").on("update",function(e){var t=e.models.map(function(e){return e.id});r.find('input[name$="[ids]"]').val(t.join(","))});s.on("escape",function(){r.find(".ui-dialog-content").dialog("open")});return!1}},".so-gallery-widget-select-attachments")});jQuery(function(e){var t={};t[panels.i10n.buttons.done]=function(){e("#grid-styles-dialog").dialog("close")};e("#grid-styles-dialog").data("html",e("#grid-styles-dialog").html());e("#grid-styles-dialog").show().dialog({dialogClass:"panels-admin-dialog",autoOpen:!1,modal:!1,draggable:!1,resizable:!1,title:e("#grid-styles-dialog").attr("data-title"),maxHeight:Math.round(e(window).height()*.8),width:500,open:function(){var t=e('<div class="siteorigin-panels ui-widget-overlay ui-widget-overlay ui-front"></div>').css("z-index",80001);e(this).data("overlay",t).closest(".ui-dialog").before(t)},close:function(){e(this).data("overlay").remove();var t=e("#grid-styles-dialog").data("container");e("#grid-styles-dialog [data-style-field]").each(function(){var n=e(this),r=t.find('[data-style-field="'+n.data("style-field")+'"]');switch(n.data("style-field-type")){case"checkbox":r.val(n.is(":checked")?"true":"");break;default:r.val(n.val())}})},buttons:t});panels.loadStyleValues=function(t){e("#grid-styles-dialog").data("container",t).html(e("#grid-styles-dialog").data("html"));t.find("[data-style-field]").each(function(){var t=e(this),n=e('#grid-styles-dialog [data-style-field="'+t.data("style-field")+'"]');switch(n.data("style-field-type")){case"checkbox":n.attr("checked",t.val()?!0:!1);break;default:n.val(t.val())}});e("#grid-styles-dialog").dialog("open");panels.colorField();panels.imageField()};panels.colorField=function(){e('#grid-styles-dialog [data-style-field-type="color"]').wpColorPicker().closest("p").find("a").click(function(){e("#grid-styles-dialog").dialog("option","position","center")})};panels.imageField=function(){var t=e('.ui-dialog [data-style-field-type="image"]');t.each(function(){var t,n=e(this);n.on("click",function(r){r.preventDefault();var i=n.attr("name");if(t){t.open();return}t=wp.media({title:"Select Image",multiple:!1,frame:"select",library:{type:"image"},button:{text:"Add Image"}});t.on("select",function(){var r=t.state().get("selection");r.each(function(r){console.log(r);var i=t.state().get("selection").first().toJSON(),s=n.data("target-input");e('input[name="'+s+'"]').val(i.url)})});t.open()})})}});(function(e){e(function(){})})(jQuery);